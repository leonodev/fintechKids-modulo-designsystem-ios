name: iOS Tests Simple

on:
  pull_request:
    branches: [develop]
  push:
    branches: [develop]

jobs:
  test:
    runs-on: macos-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.4'
    
    - name: Test with resolved dependencies
      working-directory: ./Demo/FHKDesignSystemDemo
      run: |
        # Paso 1: Resolver dependencias expl√≠citamente
        echo "Resolviendo dependencias del paquete..."
        xcodebuild -resolvePackageDependencies \
          -project FHKDesignSystemDemo.xcodeproj \
          -clonedSourcePackagesDirPath "$(pwd)/../.swiftpm"
        
        # Paso 2: Ejecutar tests
        echo "Ejecutando tests..."
        xcodebuild test \
          -project FHKDesignSystemDemo.xcodeproj \
          -scheme FHKDesignSystemDemo \
          -destination 'platform=iOS Simulator,name=iPhone 15' \
          -clonedSourcePackagesDirPath "$(pwd)/../.swiftpm" \
          CODE_SIGNING_ALLOWED=NO
