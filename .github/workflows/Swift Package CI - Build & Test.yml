name: Debug Test Failure

on: workflow_dispatch

jobs:
  debug:
    runs-on: macos-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.2'
    
    - name: Paso a paso
      working-directory: ./Demo/FHKDesignSystemDemo
      run: |
        echo "1. Listar esquemas:"
        xcodebuild -project FHKDesignSystemDemo.xcodeproj -list
        
        echo ""
        echo "2. Construir solo:"
        if xcodebuild build \
          -project FHKDesignSystemDemo.xcodeproj \
          -scheme FHKDesignSystemDemo \
          -destination 'platform=iOS Simulator,name=iPhone 15' \
          CODE_SIGNING_ALLOWED=NO; then
          echo "âœ… Build exitoso"
        else
          echo "âŒ Build fallÃ³"
          exit 1
        fi
        
        echo ""
        echo "3. Verificar tests disponibles:"
        xcodebuild -project FHKDesignSystemDemo.xcodeproj \
          -scheme FHKDesignSystemDemo \
          -showTestPlan
        
        echo ""
        echo "4. Ejecutar solo UNA clase de test (si existe):"
        # Buscar nombres de clases de test
        find . -name "*Test*.swift" -type f | head -5
        
        echo ""
        echo "5. Intentar con un test especÃ­fico:"
        xcodebuild test \
          -project FHKDesignSystemDemo.xcodeproj \
          -scheme FHKDesignSystemDemo \
          -destination 'platform=iOS Simulator,name=iPhone 15' \
          CODE_SIGNING_ALLOWED=NO \
          -only-testing:FHKDesignSystemDemoTests 2>&1 | head -150
