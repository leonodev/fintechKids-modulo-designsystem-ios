name: CI Build and Test - Final Stable

on:
push:
branches: [develop]
pull_request:
branches: [develop]
workflow_dispatch:

jobs:
build-and-test:
name: Build and Test with Swift 6.2

# macos-14 usa runners de Apple Silicon (ARM64)
runs-on: macos-14

steps:
  - name: Checkout Repository
    uses: actions/checkout@v4
    
  # 1. Seleccionar Xcode 16.2
  - name: Select Xcode 16.2
    uses: maxim-lobanov/setup-xcode@v1
    with:
      xcode-version: '16.2'
      
  # 2. Configurar el Toolchain de Swift 6.2
  - name: Setup Swift 6.2 Toolchain
    uses: swift-actions/setup-swift@v2
    with:
      swift-version: '6.2'
      
  # 3. ðŸš€ Ejecutar las Pruebas Unitarias para el Simulador
  # Comando final estable: swift test con arquitectura ARM64 para el runner macos-14.
  - name: Run Unit Tests for iOS Simulator
    run: swift test --sdk iphonesimulator --arch arm64 --enable-code-coverage
