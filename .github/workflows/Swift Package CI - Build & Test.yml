name: Swift Package CI - Build & Test (Swift 6.2 + iOS v26/18 SDK)

on:
  push:
    branches: [ develop ]
  pull_request:
    branches: [ develop ]
  workflow_dispatch:

jobs:
  build-and-test:
    name: Build and Test with Xcode 16
    runs-on: macos-14 
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        
      # 游 Paso 2: Seleccionar la 칰ltima versi칩n de Xcode 16 disponible (USANDO ACCI칍N V츼LIDA)
      - name: Select latest Xcode 16
        uses: maxim-lobanov/setup-xcode@v1 # <-- 춰ACCION CORREGIDA!
        with:
          # Selecciona la versi칩n m치s reciente que comienza con 16 (p. ej., 16.0, 16.1)
          xcode-version: '16' 
          
      # Paso 3: Configurar el Toolchain de Swift 6.2 (Obligatorio para .iOS(.v26))
      # Esto permite que el compilador de Swift 6.2 eval칰e correctamente .iOS(.v26)
      - name: Setup Swift 6.2 Toolchain
        uses: swift-actions/setup-swift@v2
        with:
          swift-version: '6.2'
          
      # Paso 4: Compilar el Paquete Swift
      # Ahora, con Xcode 16 activo y Swift 6.2, esto deber칤a compilar.
      - name: Build Swift Package
        run: swift build
        
      # Paso 5: Ejecutar las Pruebas Unitarias (Usando el comando est치ndar para paquetes)
      - name: Run Unit Tests
        run: swift test --enable-code-coverage
